webpackJsonp([1],{0:function(e,t){},HQs5:function(e,t){},L8S8:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("7+uW"),i={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var a=n("VU/8")({name:"App"},i,!1,function(e){n("QdoG")},null,null).exports,r=n("/ocq"),s={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"div-table"},[n("div",{staticClass:"div-table-row"},e._l(e.columns,function(t,o){return n("div",{staticClass:"div-table-col"},[e._v(e._s(t))])})),e._v(" "),e._l(e.tableData,function(t,o){return n("div",{staticClass:"div-table-row"},e._l(t,function(t,o){return n("div",{staticClass:"div-table-col"},[e._v(e._s(t))])}))})],2)},staticRenderFns:[]};var l=n("VU/8")({name:"Table",props:["columns","tableData"],data:function(){return{}}},s,!1,function(e){n("cOlk")},"data-v-6c8eb09a",null).exports,u={render:function(){var e=this.$createElement;return(this._self._c||e)("div",[this._v("Loading........")])},staticRenderFns:[]};var c=n("VU/8")({name:"Loading"},u,!1,function(e){n("L8S8")},"data-v-241276bc",null).exports,d=n("T1ft"),v=n.n(d),m=n("Zrlr"),h=n.n(m),p=n("wxAW"),f=n.n(p),_=function(){function e(t){h()(this,e),this._holder=t}return f()(e,[{key:"register",value:function(){var t={identifierRegexps:[/[^\s]+/],getCompletions:function(t,n,o,i,a){a(null,e.keywords().filter(function(e){return e.includes(i)}).map(function(e){return{value:e,meta:"code"}}))}};this._holder.lang_tools().addCompleter(t)}}],[{key:"keywords",value:function(){return["load","save","train","register","options","connect","options","partitionBy","append","overwrite","errorIfExists","ignore"]}}]),e}(),b=function(){function e(t){h()(this,e),this._holder=t}return f()(e,[{key:"selection",value:function(){var e=this._holder.editor(),t=e.getSelectionRange();return e.session.getTextRange(t)}}]),e}(),g=function(){function e(t){h()(this,e),this._ace=n("kX7f");var o=t.$children.filter(function(e){return"editor"===e.$options._componentTag})[0];this._editor=o.editor,this._lang_tool=this._ace.acequire("ace/ext/language_tools"),this._tool=new b(this)}return f()(e,[{key:"tool",value:function(){return this._tool}},{key:"editor",value:function(){return this._editor}},{key:"lang_tools",value:function(){return this._lang_tool}},{key:"ace",value:function(){return this._ace}}]),e}(),w=function(){function e(t){h()(this,e),this._holder=t}return f()(e,[{key:"register",value:function(){var e=this._holder;e.editor().commands.addCommand({name:"expand",bindKey:{win:"Tab",mac:"Tab"},exec:function(t){var n=t.getCursorPosition(),o=t.session.getLine(n.row),i=e.ace().acequire("ace/range").Range;"load"===o.trim()&&t.session.replace(new i(n.row,0,n.row,n.column),"load parquet.`[path]`\noptions [key]=[value]\nas [tableName];\n"),"save"===o.trim()&&t.session.replace(new i(n.row,0,n.row,n.column),"save append [tableName] as parquet.`[path]`\noptions [key]=[value]\npartitionBy [column];\n"),"train"===o.trim()&&t.session.replace(new i(n.row,0,n.row,n.column),"train [tableName] [moduleName].`[path]` where [key]=[value];\n"),"register"===o.trim()&&t.session.replace(new i(n.row,0,n.row,n.column),"register [moduleName].`[path]` as [functionName] options [key]=[value];\n")}})}}]),e}(),k=n("DtRx"),y={name:"Query",data:function(){return{msg:"MLSQL is cool",content:"select 1 as a,'jack' as b as bbc;",editor_options:{enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0},resource:{job_url:"/run/script",kill_job_url:"/killjob"},holder:{},result:{columns:[],tableData:[],msg:"",loading:!1,editor_modes:[{id:0,label:"normal"},{id:1,label:"vim"}],editor_mode_selected:{id:0,label:"normal"}}}},methods:{editorInit:function(){n("R3yc"),n("2i/5"),n("QWRE");this.holder=new g(this),new _(this.holder).register(),new w(this.holder).register()},submitRunSQL:function(e){var t=this.resource.job_url,n=this;n.jobName=k(),n.result.loading=!0;var o=n.holder.tool().selection(),i=n.content;""!=o&&(i=o),n.$http.post(t,{sql:i,owner:"admin",jobName:n.jobName},{emulateJSON:!0}).then(function(e){n.result.loading=!1;var t=e.data,o=[],i={};t.forEach(function(e){for(var t in e)i[t]||(o.push(t),i[t]=!0)}),n.result.columns=o,n.result.tableData=[],t.forEach(function(e){var t={};o.forEach(function(n){t[n]=e[n]}),n.result.tableData.push(t)})},function(e){n.result.loading=!1,n.result.msg=e.bodyText})},cancelJob:function(e){var t=this.resource.kill_job_url,n=this;n.$http.post(t,{jobName:n.jobName},{emulateJSON:!0}).then(function(e){n.result.loading=!1,n.result.msg="the job is aborded success"},function(e){n.result.loading=!1})}},components:{editor:n("o4sT"),vtable:l,vloading:c,vSelect:v.a}},x={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"query_box"},[n("div",{staticClass:"editor_mode_select"},[n("span",[e._v("编辑器模式")]),e._v(":\n    "),n("vSelect",{attrs:{options:e.result.editor_modes},model:{value:e.result.editor_mode_selected,callback:function(t){e.$set(e.result,"editor_mode_selected",t)},expression:"result.editor_mode_selected"}})],1),e._v(" "),n("div",{attrs:{id:"editor"}},[n("editor",{attrs:{lang:"sql",theme:"twilight",width:"100%",height:"300px",options:e.editor_options},on:{init:e.editorInit},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}),e._v(" "),n("div",[n("button",{staticClass:"btn btn-run waves-effect",on:{click:e.submitRunSQL}},[e._v("运行")]),e._v(" "),n("button",{staticClass:"btn btn-cancel waves-effect",on:{click:e.cancelJob}},[e._v("取消")])]),e._v(" "),e.result.loading?n("vloading"):e._e()],1),e._v(" "),n("div",{attrs:{id:"show_result"}},[""!=e.result.msg?n("editor",{attrs:{lang:"text",width:"100%",height:"100px"},model:{value:e.result.msg,callback:function(t){e.$set(e.result,"msg",t)},expression:"result.msg"}}):e._e(),e._v(" "),e.result.tableData.length>0?n("vtable",{attrs:{"table-data":e.result.tableData,columns:e.result.columns}}):e._e()],1)])},staticRenderFns:[]};var N=n("VU/8")(y,x,!1,function(e){n("HQs5")},"data-v-58472efe",null).exports;o.a.use(r.a);var C=new r.a({routes:[{path:"/",name:"Query",component:N}]}),j=n("8+8L");o.a.config.productionTip=!1,o.a.use(j.a),o.a.http.options.xhr={withCredentials:!0},new o.a({el:"#app",router:C,components:{App:a},template:"<App/>"})},QdoG:function(e,t){},cOlk:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.44c1f54b7395cfee49fd.js.map